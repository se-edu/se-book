{% from "common/macros.njk" import trail, bold_number, callout, hp_number, label, show_commit, show_git_term, show_git_term_tip, show_detour, show_exercise, show_git_tabs, show_hands_on_practical, show_lesson_intro, show_output, show_ref, show_under_the_hood with context %}

<span id="prereqs"></span>
<span id="outcomes">...</span>
<span id="title">{{ trail.usingRevisionHistory.lessons.log.title }}</span>

<div id="body">
{% call show_lesson_intro() %}
It is useful to be able to **visualise the commits timeline, aka the _revision graph_.**

{% endcall %}

**The Git data model consists of two types of entities: {{ show_git_term("objects") }} and {{ show_git_term("refs") }}** (short for _references). In this lesson, you will encounter examples of both.

**A Git {{ show_git_term("revision graph") }} is visualisation of a repo's revision history**, contains examples of both objects and refs. First, let us learn to work with simpler revision graphs consisting of one branch, such as the one given below.


{{ show_commit('C3') }}
{{ show_commit('C2') }}
{{ show_commit('C1', edge='') }}
<p/>

**Nodes in the revision graph represent commits.**

* **A commit is one of four main types of Git {{ show_git_term("objects") }}** (blobs, trees, and annotated tags are the other three, to be covered later).
* **A commit identified by its {{ show_git_term("SHA") }} value**. A SHA (Secure Hash Algorithm) value is a unique identifier generated by Git to represent each commit. It is produced by using SHA-1 (i.e., one of the algorithms in the SHA family of cryptographic hash functions) on the entire content of the commit. It's a 40-character hexadecimal string (e.g., `f761ea63738a67258628e9e54095b88ea67d95e2`) that acts like a fingerprint, ensuring that every commit can be referenced unambiguously.
* A commit is a full snapshot of the working directory, constructed based on the previous commit, and the  changes staged. **The previous commit a commit is based on is called the {{ show_git_term("parent commit") }}** %%(some commits can have multiple parent commits -- we’ll cover that later)%%.

**Edges in the revision graph represent links between a commit and its parent commit(s)** In some revision graph visualisations, you might see arrows (instead of lines) showing how each commit points to its parent commit.

{{ show_commit('C3', edge="↓") }}
{{ show_commit('C2', edge="↓") }}
{{ show_commit('C1', edge='') }}
<p/>

**Git uses refs to name and keep track of various points in a repository’s history.** These refs are essentially 'named-pointers' that can serve as bookmarks to reach a certain point in the revision graph using the ref name.

{{ show_commit('C3', desc=show_ref('master') + ' ' + show_ref('HEAD', style='danger')) }}
{{ show_commit('C2') }}
{{ show_commit('C1', edge='') }}
<p/>

In the revision graph above, there are two refs {{ show_ref('master') }} and {{ show_ref('HEAD', style='danger')}}.

* {{ show_ref('master') }} is a {{ show_git_term("branch ref") }}. A branch points to the latest commit on a branch. **When you create a new commit, the ref of the branch we are currently in moves to the new commit.**
* {{ show_ref('HEAD', style='danger')}} is a special ref. Normally, it points to the current branch (in this example, it is pointing to the `master` branch), and moves together with the branch ref.

{{ show_commit('C3', desc=show_ref('master', arrow='↙') + ' ' + show_ref('HEAD', style='danger') + '<br>' + show_ref('origin/master', arrow="↖")) }}
{{ show_commit('C2') }}
{{ show_commit('C1', edge='') }}
<p/>

In the revision graph above you see a third type of ref ({{ show_ref('origin/master', arrow="↖") }}). This is a {{ show_git_term("remote tracking") }} branch ref that represents the state of a branch in a remote repository (if you previously set up the branch to track a remote branch). In this example, the `master` branch in the remote `origin` is also at the commit `C3` (which means you have not created new commits after you pushed to the remote).

If you now create a new commit `C4`, the state of the revision graph will be as follows:

{{ show_commit('#y#C4##', desc=show_ref('master') + ' ' + show_ref('HEAD', style='danger'), style="primary") }}
{{ show_commit('C3', desc= show_ref('origin/master')) }}
{{ show_commit('C2') }}
{{ show_commit('C1', edge='') }}
<p/>

Explanation: When you create `C4`, the current branch `master` move to point to `C4`, and `HEAD` moves along with it. However, the `master` branch in the remote `origin` remains at `C3` (because you have not pushed `C4` yet).

{% call show_hands_on_practical('View the revision graph')  %}

Let us use Git features to examine the revision graph of a simple repo. For this, use a repo with just a few commits and only one branch for this hands-on practical.

{{ show_git_tabs('-view-rg-normal') }}
{% endcall %}

</div>
<div id="extras">
</div>
