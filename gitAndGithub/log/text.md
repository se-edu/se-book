{% from "common/macros.njk" import trail, bold_number, callout, hp_number, label, show_commit, show_git_term, show_git_term_tip, show_detour, show_exercise, show_git_tabs, show_git_tabs_from_text, show_hands_on_practical, show_head, show_lesson_intro, show_lesson_link, show_output, show_ref, show_resources, show_sidebar, show_tag, show_transformation_columns, show_under_the_hood with context %}

<span id="prereqs"></span>
<span id="outcomes">Able to view the revision graph, and changes included in each commit.</span>
<span id="title">{{ trail.recordingFolderHistory.lessons.log.title }}</span>

<div id="body">
{% call show_lesson_intro() %}
It is useful to be able to **visualise the commits timeline, aka the _revision graph_.**

{% endcall %}

**Git commits form a timeline**, as each corresponds to a point in time when you asked Git to take a snapshot of your working directory. Each commit links to at least one previous commit, forming a structure that we can traverse.<br>
**A timeline of commits is called a {{ show_git_term('branch') }}**. By default, Git names the initial branch `master` -- though many now use `main` instead. You'll learn more about branches in future lessons. For now, just be aware that the commits you create in a new repo will be on a branch called `master` (or `main`) by default.

<mermaid>
gitGraph
    {{ "%%{init: { 'theme': 'default', 'gitGraph': {'mainBranchName': 'master (or main)'}} }%%" }}
    commit id: "Add fruits.txt"
    commit id: "Update fruits.txt"
    commit id: "Add colours.txt"
    commit id: "..."
</mermaid>

**Git can show you the list of commits** in the Git history.

{% call show_hands_on_practical("Viewing the list of commits") %}

{{ hp_number('Preparation') }} Use the `things` repo you created in a previous lesson. Alternatively, you can use the commands given below to create such a repo from scratch.

```bash
mkdir things  # create a folder for the repo
cd things
git init
echo -e "apples\nbananas\ncherries\ndragon fruits" > fruits.txt
git add fruits.txt
git commit -m "Add fruits.txt"
```

<box type="tip" seamless>

**You can copy-paste a list of commands** (such as commands given above), including any comments, to the terminal. After that, hit <kbd>enter</kbd> to run them in sequence.
</box>

{{ hp_number('1') }} **View the list of commits**, which should show just the one commit you created just now.

{{ show_git_tabs('_2', indent_level=1) }}

{{ hp_number('2') }} **Create a few more commits** (i.e., a few rounds of add/edit files → stage → commit), and observe how the list of commits grows.

{{ show_git_tabs('_3', indent_level=1) }}
{% endcall %}


**The Git data model consists of two types of entities: {{ show_git_term("objects") }} and {{ show_git_term("refs") }}** (short for _references_). In this lesson, you will encounter examples of both.

**A Git {{ show_git_term("revision graph") }} is a visualisation of a repo's revision history**, consisting of one or more branches. First, let us learn to work with simpler revision graphs consisting of one branch, such as the one given below.

{{ show_commit('C3') }}
{{ show_commit('C2') }}
{{ show_commit('C1', edge='') }}
<p/>

* **Nodes in the revision graph represent commits.** **A commit is one of four main types of Git {{ show_git_term("objects") }}**. For completeness, the other three are:
  * **blob** (short for **binary large object**): stores the contents of a file
  * **tree**: represents a directory and records the hierarchy of its contents by referencing blobs and other trees
  * **tag** (specifically, _annotated_ tag): a label-like object that can store additional metadata and point to a specific commit
* **A commit is identified by its {{ show_git_term("SHA") }} value**. A SHA (Secure Hash Algorithm) value is a unique identifier generated by Git to represent each commit. It is produced by using SHA-1 (i.e., one of the algorithms in the SHA family of cryptographic hash functions) on the entire content of the commit. It's a 40-character hexadecimal string (e.g., `f761ea63738a67258628e9e54095b88ea67d95e2`) that acts like a fingerprint, ensuring that every commit can be referenced unambiguously. That is, **every commit has a unique SHA-1 hash value**.
* A commit is a full snapshot of the working directory, constructed based on the previous commit, and the  changes staged. That means **each commit (except the initial commit) is based on a another {{ show_git_term("'parent' commit") }}**. Some commits can have multiple parent commits -- we’ll cover that later.


<box type="important" class="non-printable" seamless>

Given every commit has a unique hash, the #r#commit hash values you see in our examples will be different from the hash values of your own commits##, for example, when following our hands-on practicals.
</box>


**Edges in the revision graph represent links between a commit and its parent commit(s).** In some revision graph visualisations, you might see arrows (instead of lines) showing how each commit points to its parent commit.

{{ show_commit('C3', edge="↓") }}
{{ show_commit('C2', edge="↓") }}
{{ show_commit('C1', edge='') }}
<p/>

**Git uses refs to name and keep track of various points in a repository’s history.** These refs are essentially 'named-pointers' that can serve as bookmarks to reach a certain point in the revision graph using the ref name.

{{ show_commit('C3', desc=show_ref('master') + show_head()) }}
{{ show_commit('C2') }}
{{ show_commit('C1', edge='') }}
<p/>

In the revision graph above, there are two refs {{ show_ref('master') }} and &nbsp;{{ show_head()}}.

* {{ show_ref('master') }} is a branch ref. **A {{ show_git_term("branch ref") }} points to the latest commit on a branch**. In this visualisation, the commit shown alongside the ref is the one it points to i.e., `C3`.<br>
  **When you create a new commit, the branch ref of the <tooltip content="the currently active branch">current</tooltip> branch moves to the new commit.**
* **{{ show_head()}} is a special ref that typically points to the current branch and moves along with that branch ref.** In this example, it is pointing to the `master` branch.<br>
  In certain cases, the `HEAD` may point directly to a specific commit instead of a branch. This situation is called a "detached `HEAD`", which will be covered in a later lesson.


{% call show_hands_on_practical('View the revision graph')  %}

{{ hp_number(hop_target) }} **Use Git features to examine the revision graph of a simple repo.**

{{ hp_number(hop_preparation) }} Use a repo with just a few commits and only one branch.

{{ show_git_tabs('-view-rg-normal') }}

{% endcall %} <!-- end hop -->

</div>
<div id="extras">
</div>
